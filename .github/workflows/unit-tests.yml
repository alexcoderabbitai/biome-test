name: Unit Tests
on:
  pull_request:
    paths:
        - 'project/gh-action/**'
  push:
    branches:
        - main
    paths:
        - 'project/gh-action/**'

jobs:
    python-tests:
        runs-on: ubuntu-latest
        defaults:
            run:
                working-directory: project/gh-action/python
        steps:
            - uses: actions/checkout@v4
            - uses: actions/setup-python@v4
              with:
                  python-version: '3.11'

            - name: Install dependencies
              run: pip install -r requirements.txt

            - name: Run tests
              run: |
                python -m pytest --cov=. --cov-report=xml

    node-tests:
        runs-on: ubuntu-latest
        defaults:
            run:
                working-directory: project/gh-action/node
        steps:
            - uses: actions/checkout@v4
            - uses: actions/setup-node@v3
              with:
                  node-version: '18'
            
            - name: Install dependencies
              run: npm ci

            - name: Run tests
              run: npm test